# Домашнее задание по лекции "3.7 Компьютерные сети (лекция 2)"
## 1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?
### Ответ:
В Linux для просмотра сетевых интерфейсов используется утилита `ip` (в данном случае с параметром `link`), 
ранее использовалась утилита `ifconfig` однако сейчас во многих дистрибутивах ее по умолчанию уже нет.
В Windows используется утилита `ipconfig` пример применения указан в решении.
### Решение:
```
PS C:\Users\user> ipconfig

Настройка протокола IP для Windows


Неизвестный адаптер OpenVPN Wintun:

   Состояние среды. . . . . . . . : Среда передачи недоступна.
   DNS-суффикс подключения . . . . . :

Неизвестный адаптер ProtonVPN TUN:

   Состояние среды. . . . . . . . : Среда передачи недоступна.
   DNS-суффикс подключения . . . . . :

Адаптер Ethernet VirtualBox Host-Only Network:

   DNS-суффикс подключения . . . . . :
   Локальный IPv6-адрес канала . . . : fe80::1910:9584:cc09:5354%17
   IPv4-адрес. . . . . . . . . . . . : 192.168.56.1
   Маска подсети . . . . . . . . . . : 255.255.255.0
   Основной шлюз. . . . . . . . . :

Неизвестный адаптер OpenVPN TAP-Windows6:

   DNS-суффикс подключения . . . . . : lf.local
   Локальный IPv6-адрес канала . . . : fe80::b971:adcf:c6b9:490b%19
   IPv4-адрес. . . . . . . . . . . . : 10.50.10.106
   Маска подсети . . . . . . . . . . : 255.255.255.252
   Основной шлюз. . . . . . . . . :

Неизвестный адаптер Подключение по локальной сети:

   Состояние среды. . . . . . . . : Среда передачи недоступна.
   DNS-суффикс подключения . . . . . :

Адаптер Ethernet Ethernet 2:

   DNS-суффикс подключения . . . . . : GREED
   Локальный IPv6-адрес канала . . . : fe80::88ac:c715:a02b:2487%5
   IPv4-адрес. . . . . . . . . . . . : 10.50.20.100
   Маска подсети . . . . . . . . . . : 255.255.255.0
   Основной шлюз. . . . . . . . . : 10.50.20.1
```
## 2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?
### Ответ:
Для распознавания соседей по сетевому интерфейсу используется протокол LLDP (существуют и другие протоколы, в т.ч.
проприетарные). Для использования возможностей протокола в Linux используется утилита `lldpd`, после его установки
необходимо установить его как демон и запустить, после чего используя команду `lldpctl` можно увидеть информацию
о соседях на интерфейсе (при условии, конечно, что у соседей разрешена передача данной информации).
## 3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.
### Ответ:
Технология VLAN. В Linux для работы с VLAN используется пакет `vlan`. После его установки в файле настройки интерфейсов
`/etc/network/interfaces` необходимо прописать интерфейсы vlan, пример из лекции:
```shell
auto vlan1400
iface vlan1400 inet static
 address 192.168.1.1
 netmask 255.255.255.0
 vlan_raw_device eth0
auto eth0.1400
iface eth0.1400 inet static
 address 192.168.1.1
 netmask 255.255.255.0
 vlan_raw_device eth0
```
Однако, сейчас ОС семейства Linux переходят к настройкам сетевых интерфейсов через `netplan`, в этом случае в файле
`/etc/netplan/01-netcfg.yaml` следует добавить следующие строки:
```yaml
vlans:
  vlan400:       #VLAN name
    id: 400      #VLAN ID
    link: eth0  #Interface
    dhcp4: true #DHCP enable
```
Далее следует проверить конфигурацию командой `netplan generate`, после чего применить конфигурацию командой 
`netplan apply`
## 4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.
###  Ответ:
В Linux есть следующие виды агрегации с различными вариантами балансировки:
* **Mode-0 (balance-rr)** – Данный режим используется по умолчанию. Balance-rr обеспечивается балансировку нагрузки
и отказоустойчивость. В данном режиме сетевые пакеты отправляются “по кругу”, от первого интерфейса к последнему. 
Если выходят из строя интерфейсы, пакеты отправляются на остальные оставшиеся. Дополнительной настройки коммутатора 
не требуется при нахождении портов в одном коммутаторе. При разностных коммутаторах требуется дополнительная настройка.
* **Mode-1 (active-backup)** – Один из интерфейсов работает в активном режиме, остальные в ожидающем. При обнаружении 
проблемы на активном интерфейсе производится переключение на ожидающий интерфейс. Не требуется поддержки от коммутатора.
* **Mode-2 (balance-xor)** – Передача пакетов распределяется по типу входящего и исходящего трафика по формуле 
_`((MAC src) XOR (MAC dest)) % <число интерфейсов>`_. Режим дает балансировку нагрузки и отказоустойчивость. 
Не требуется дополнительной настройки коммутатора/коммутаторов.
* **Mode-3 (broadcast)** – Происходит передача во все объединенные интерфейсы, тем самым обеспечивая отказоустойчивость.
Рекомендуется только для использования MULTICAST трафика.
* **Mode-4 (802.3ad или LACP)** – динамическое объединение одинаковых портов. В данном режиме можно значительно 
увеличить пропускную способность входящего так и исходящего трафика. Для данного режима необходима поддержка 
и настройка коммутатора/коммутаторов.
* **Mode-5 (balance-tlb)** – Адаптивная балансировки нагрузки трафика. Входящий трафик получается только активным 
интерфейсом, исходящий распределяется в зависимости от текущей загрузки канала каждого интерфейса. Не требуется
специальной поддержки и настройки коммутатора/коммутаторов.
* **Mode-6 (balance-alb)** – Адаптивная балансировка нагрузки. Отличается более совершенным алгоритмом балансировки 
нагрузки чем Mode-5. Обеспечивает балансировку нагрузки как исходящего, так и входящего трафика. Не требуется 
 специальной поддержки и настройки коммутатора/коммутаторов.

**Пример конфигурации `netplan` для настройки агрегации через LACP:**
```yaml
network: 
    renderer: networkd 
    version: 2 
    ethernets: 
        eth0:
          dhcp4: no
        eth1:
          dhcp4: no
    bonds: 
      bond0:
        dhcp4: true
        interfaces: [eth0, eth1]
        parameters:
          mode: 802.3ad
          mii-monitor-interval: 1
```
## 5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.
### Ответ:
В подсети с маской /29 имеется 6 адресов (8 если считать адрес самой сети и бродкаст адрес).

Из сети /24 можно получить 32 подсети с маской 29 (256 // 8 = 32).

Примеры сетей:
* 10.10.10.0/29
* 10.10.10.8/29
* 10.10.10.16/29
* ...
* 10.10.10.240/29
* 10.10.10.248/29
## 6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.
### Ответ:
Возможно использовать адреса из подсети 100.64.0.0/10: например 100.64.0.0/26.

### Дополнительно:
В крайнем случае, если занято вообще всё, можно воспользоваться глобальными адресами, при условии, что
из нашей сети нам никогда не потребуется заходить на данные глобальные адреса. Конечно, так делать крайне не желательно.
## 7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?
### Ответ:
Для просмотра ARP таблицы в Linux можно использовать команду `ip neigh`, в Windows `arp -a`. 

Для очистки ARP таблицы в Linux `ip link set arp off dev <interface>; ip link set arp on dev <interface>` (команда 
`ip -s neigh flush all` не удаляет записи, а делает их недействительными), в Windows `netsh interface ip delete arpcache`

Удалить конкретную запись в Linux `ip neigh del dev <interface> <host>`, в Windows `arp -d <host>`

## 8* Установите эмулятор [EVE-ng](https://github.com/svmyasnikov/eve-ng).
### Комментарий:
Отличный эмулятор сети, используем на работе, приятно что в отличии от подобного решения Cisco позволяет эмулировать
устройства других производителей. Так же позволяет создавать виртуальные машины и на ходу проверять как будет реагировать на изменения например Windows или Ubuntu.